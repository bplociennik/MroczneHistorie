  ╔════════════════════════════════════════════════════════════════════════════╗
  ║                          MROCZNE HISTORIE - ARCHITEKTURA                   ║
  ╚════════════════════════════════════════════════════════════════════════════╝

  ┌─────────────────────────────────────────────────────────────────────────────┐
  │                          EXTERNAL SERVICES                                  │
  ├─────────────────────────────────────────────────────────────────────────────┤
  │  ┌──────────────┐              ┌──────────────┐                            │
  │  │   Supabase   │              │   OpenAI     │                            │
  │  │   (BaaS)     │              │   API        │                            │
  │  │              │              │              │                            │
  │  │ - Auth       │              │ - GPT-4o     │                            │
  │  │ - PostgreSQL │              │ - Generation │                            │
  │  │ - RLS        │              │              │                            │
  │  └──────┬───────┘              └──────┬───────┘                            │
  │         │                             │                                    │
  └─────────┼─────────────────────────────┼────────────────────────────────────┘
            │                             │
            └─────────────┬───────────────┘
                          │
  ┌───────────────────────▼─────────────────────────────────────────────────────┐
  │                         BACKEND LAYER                                       │
  ├─────────────────────────────────────────────────────────────────────────────┤
  │                                                                             │
  │  ┌──────────────────────────────────────────────────────────────────────┐  │
  │  │                    SVELTEKIT SERVER SIDE                             │  │
  │  ├──────────────────────────────────────────────────────────────────────┤  │
  │  │                                                                      │  │
  │  │  API Routes (/src/routes/api)                                       │  │
  │  │  ┌────────────────────┐  ┌────────────────────┐                    │  │
  │  │  │ /api/stories       │  │ /api/stories/      │                    │  │
  │  │  │                    │  │    random          │                    │  │
  │  │  │ - POST (create)    │  │                    │                    │  │
  │  │  │ - GET (list)       │  │ - GET              │                    │  │
  │  │  └────────────────────┘  └────────────────────┘                    │  │
  │  │                                                                      │  │
  │  │  ┌─────────────────────────────────────────────┐                   │  │
  │  │  │ /api/stories/[id]                           │                   │  │
  │  │  │                                             │                   │  │
  │  │  │ - GET (detail)                              │                   │  │
  │  │  │ - PUT (update)                              │                   │  │
  │  │  │ - DELETE                                    │                   │  │
  │  │  └─────────────────────────────────────────────┘                   │  │
  │  │                                                                      │  │
  │  │  Server Load Functions (+page.server.ts)                           │  │
  │  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐              │  │
  │  │  │ / (home)     │ │ /login       │ │ /register    │              │  │
  │  │  │ - load       │ │ - actions    │ │ - actions    │              │  │
  │  │  │ - stories    │ └──────────────┘ └──────────────┘              │  │
  │  │  └──────────────┘                                                  │  │
  │  │  ┌──────────────┐ ┌──────────────────────────┐                   │  │
  │  │  │ /generate    │ │ /stories/[id]/edit       │                   │  │
  │  │  │ - actions    │ │ - load, actions          │                   │  │
  │  │  └──────────────┘ └──────────────────────────┘                   │  │
  │  │                                                                      │  │
  │  └──────────────────────────────────────────────────────────────────────┘  │
  │                                                                             │
  │  ┌──────────────────────────────────────────────────────────────────────┐  │
  │  │ Services & Utils                                                     │  │
  │  ├──────────────────────────────────────────────────────────────────────┤  │
  │  │  $lib/services/                  $lib/validation/                   │  │
  │  │  └─ ai/openai.service.ts          └─ story.validation.ts            │  │
  │  │                                                                      │  │
  │  │  $lib/server/utils/                                                 │  │
  │  │  └─ api-error.ts                                                    │  │
  │  └──────────────────────────────────────────────────────────────────────┘  │
  └─────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     │
  ┌──────────────────────────────────▼──────────────────────────────────────────┐
  │                         FRONTEND LAYER                                      │
  ├─────────────────────────────────────────────────────────────────────────────┤
  │                                                                             │
  │  ┌──────────────────────────────────────────────────────────────────────┐  │
  │  │                    ROOT LAYOUT (+layout.svelte)                      │  │
  │  ├──────────────────────────────────────────────────────────────────────┤  │
  │  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐        │  │
  │  │  │    Navbar      │  │ GlobalLoader   │  │ ToastContainer │        │  │
  │  │  │                │  │                │  │                │        │  │
  │  │  │ - session      │  │ - loading      │  │ - toasts       │        │  │
  │  │  │ - logout       │  │   store        │  │   store        │        │  │
  │  │  └────────────────┘  └────────────────┘  └────────────────┘        │  │
  │  │                                                                      │  │
  │  │  ┌────────────────────────────────────────────────────────────────┐ │  │
  │  │  │                     {@render children()}                       │ │  │
  │  │  └────────────────────────────────────────────────────────────────┘ │  │
  │  └──────────────────────────────────────────────────────────────────────┘  │
  │                                                                             │
  │  ┌──────────────────────────────────────────────────────────────────────┐  │
  │  │                         PAGES / ROUTES                               │  │
  │  ├──────────────────────────────────────────────────────────────────────┤  │
  │  │                                                                      │  │
  │  │  / (Home - +page.svelte)                                            │  │
  │  │  ┌─────────────────────────────────────────────────────────────┐   │  │
  │  │  │ IF !session:                                                │   │  │
  │  │  │   ┌──────────────────┐                                      │   │  │
  │  │  │   │  LandingPage     │                                      │   │  │
  │  │  │   │  - hero          │                                      │   │  │
  │  │  │   │  - features      │                                      │   │  │
  │  │  │   │  - CTA           │                                      │   │  │
  │  │  │   └──────────────────┘                                      │   │  │
  │  │  │                                                             │   │  │
  │  │  │ ELSE IF stories.length === 0:                               │   │  │
  │  │  │   ┌──────────────────┐                                      │   │  │
  │  │  │   │  EmptyState      │                                      │   │  │
  │  │  │   │  - no stories    │                                      │   │  │
  │  │  │   │  - CTA generate  │                                      │   │  │
  │  │  │   └──────────────────┘                                      │   │  │
  │  │  │                                                             │   │  │
  │  │  │ ELSE:                                                       │   │  │
  │  │  │   ┌──────────────────┐                                      │   │  │
  │  │  │   │  StoryList       │                                      │   │  │
  │  │  │   │  ┌────────────┐  │                                      │   │  │
  │  │  │   │  │ StoryCard  │  │  (multiple)                         │   │  │
  │  │  │   │  │            │  │                                      │   │  │
  │  │  │   │  │ - title    │  │                                      │   │  │
  │  │  │   │  │ - story    │  │                                      │   │  │
  │  │  │   │  │ - buttons  │  │                                      │   │  │
  │  │  │   │  └────────────┘  │                                      │   │  │
  │  │  │   └──────────────────┘                                      │   │  │
  │  │  │   ┌───────────────────────────┐                            │   │  │
  │  │  │   │  ModalConfirmDelete       │                            │   │  │
  │  │  │   │  - confirmation dialog    │                            │   │  │
  │  │  │   └───────────────────────────┘                            │   │  │
  │  │  └─────────────────────────────────────────────────────────────┘   │  │
  │  │                                                                      │  │
  │  │  /login (+page.svelte)                                              │  │
  │  │  ┌─────────────────────────────────────────────────────────────┐   │  │
  │  │  │  ┌────────────┐  ┌────────────┐                            │   │  │
  │  │  │  │ FormField  │  │ SubmitBtn  │                            │   │  │
  │  │  │  └────────────┘  └────────────┘                            │   │  │
  │  │  └─────────────────────────────────────────────────────────────┘   │  │
  │  │                                                                      │  │
  │  │  /register (+page.svelte)                                           │  │
  │  │  ┌─────────────────────────────────────────────────────────────┐   │  │
  │  │  │  ┌────────────┐  ┌────────────┐                            │   │  │
  │  │  │  │ FormField  │  │ SubmitBtn  │                            │   │  │
  │  │  │  └────────────┘  └────────────┘                            │   │  │
  │  │  └─────────────────────────────────────────────────────────────┘   │  │
  │  │                                                                      │  │
  │  │  /generate (+page.svelte)                                           │  │
  │  │  ┌─────────────────────────────────────────────────────────────┐   │  │
  │  │  │  ┌────────────┐  ┌────────────┐                            │   │  │
  │  │  │  │ FormField  │  │ SubmitBtn  │                            │   │  │
  │  │  │  └────────────┘  └────────────┘                            │   │  │
  │  │  └─────────────────────────────────────────────────────────────┘   │  │
  │  │                                                                      │  │
  │  │  /stories/[id] (+page.svelte)                                       │  │
  │  │  ┌─────────────────────────────────────────────────────────────┐   │  │
  │  │  │  ┌───────────────┐  ┌───────────────┐                      │   │  │
  │  │  │  │ ReadOnlyField │  │ Action Btns   │                      │   │  │
  │  │  │  │               │  │ - edit        │                      │   │  │
  │  │  │  │ - title       │  │ - delete      │                      │   │  │
  │  │  │  │ - story       │  │ - back        │                      │   │  │
  │  │  │  │ - solution    │  └───────────────┘                      │   │  │
  │  │  │  └───────────────┘                                          │   │  │
  │  │  └─────────────────────────────────────────────────────────────┘   │  │
  │  │                                                                      │  │
  │  │  /stories/[id]/edit (+page.svelte)                                  │  │
  │  │  ┌─────────────────────────────────────────────────────────────┐   │  │
  │  │  │  ┌────────────┐  ┌────────────┐                            │   │  │
  │  │  │  │ FormField  │  │ SubmitBtn  │                            │   │  │
  │  │  │  └────────────┘  └────────────┘                            │   │  │
  │  │  └─────────────────────────────────────────────────────────────┘   │  │
  │  └──────────────────────────────────────────────────────────────────────┘  │
  │                                                                             │
  │  ┌──────────────────────────────────────────────────────────────────────┐  │
  │  │                    SHARED COMPONENTS                                 │  │
  │  ├──────────────────────────────────────────────────────────────────────┤  │
  │  │  $lib/components/                                                    │  │
  │  │  ├─ Navbar.svelte                                                    │  │
  │  │  ├─ GlobalLoader.svelte                                              │  │
  │  │  ├─ ToastContainer.svelte                                            │  │
  │  │  ├─ LandingPage.svelte                                               │  │
  │  │  ├─ EmptyState.svelte                                                │  │
  │  │  ├─ StoryList.svelte                                                 │  │
  │  │  ├─ StoryCard.svelte                                                 │  │
  │  │  ├─ ModalConfirmDelete.svelte                                        │  │
  │  │  └─ forms/                                                           │  │
  │  │     ├─ FormField.svelte                                              │  │
  │  │     ├─ SubmitButton.svelte                                           │  │
  │  │     └─ ReadOnlyField.svelte                                          │  │
  │  └──────────────────────────────────────────────────────────────────────┘  │
  │                                                                             │
  │  ┌──────────────────────────────────────────────────────────────────────┐  │
  │  │                         STATE MANAGEMENT                             │  │
  │  ├──────────────────────────────────────────────────────────────────────┤  │
  │  │  $lib/stores/                                                        │  │
  │  │  ├─ toasts.ts      ──→  ToastContainer                              │  │
  │  │  └─ loading.ts     ──→  GlobalLoader                                │  │
  │  └──────────────────────────────────────────────────────────────────────┘  │
  │                                                                             │
  │  ┌──────────────────────────────────────────────────────────────────────┐  │
  │  │                      UTILITIES & TYPES                               │  │
  │  ├──────────────────────────────────────────────────────────────────────┤  │
  │  │  $lib/types/viewModels.ts                                            │  │
  │  │  $lib/constants/forms.ts                                             │  │
  │  │  $lib/utils/validation.ts                                            │  │
  │  └──────────────────────────────────────────────────────────────────────┘  │
  └─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────────┐
  │                            STYLING LAYER                                    │
  ├─────────────────────────────────────────────────────────────────────────────┤
  │  Tailwind CSS + DaisyUI (theme: dark)                                      │
  │  - Utility-first CSS framework                                             │
  │  - Mobile-first responsive design                                          │
  │  - Component library with pre-built UI components                          │
  └─────────────────────────────────────────────────────────────────────────────┘

  LEGEND:
    ┌─────┐
    │     │  Component/Module
    └─────┘

    ──→    Data flow / Dependency

    │      Hierarchical relationship
    ▼

  Kluczowe zależności:

  1. Layout (root) → Navbar, GlobalLoader, ToastContainer
  2. Home page → LandingPage | EmptyState | (StoryList + ModalConfirmDelete)
  3. StoryList → StoryCard (wielokrotnie)
  4. All forms → FormField, SubmitButton
  5. Story detail → ReadOnlyField
  6. Global stores → toasts (ToastContainer), loading (GlobalLoader)
  7. Backend → Supabase (auth, data), OpenAI (AI generation)
